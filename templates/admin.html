{% extends 'base.html' %}

{% block content %}
  <h1>Administrator</h1>
  <table class="table">
    <thead>
      <tr>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>Target</th>
      </tr>
    </thead>
    <tbody>
      {% for record in records %}
        <tr>
          <td>{{ record[1] }}</td>
          <td>{{ record[2] }}</td>
          <td>{{ record[3] }}</td>
          <td>{{ record[4] }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <button id="game-state-button" class="btn btn-primary" data-state="{{ gameState }}">Game State: {{ gameState }}</button>

{% endblock %}

{% block scripts %}
  {{ super() }}
  <script>
    // Get the game state button
    var gameStateButton = document.getElementById("game-state-button");
    
    // Set the initial game state
    var gameState = gameStateButton.getAttribute("data-state");
    
    // Add an event listener to the game state button
    gameStateButton.addEventListener("click", function() {
      // Toggle the game state
      if (gameState === "stopped") {
        gameState = "running";
      } else {
        gameState = "stopped";
      }
      
      // Update the button text and data-state attribute
      gameStateButton.setAttribute("data-state", gameState);
      gameStateButton.textContent = "Game State: " + gameState;
      
      // Update the game state in the database
      var xhr = new XMLHttpRequest();
      xhr.open("POST", "{{ url_for('update_game_state') }}", true);
      xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xhr.send("gameState=" + encodeURIComponent(gameState));
    });
  </script>
{% endblock %}


